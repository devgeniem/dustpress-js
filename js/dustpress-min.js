window.DustPress=function(e,r,$){var t={};if(t.defaults={type:"post",tidy:!1,render:!1,partial:null,upload:!1,data:!1,url:null,bypassMainQuery:!1,success:function(){},error:function(){},uploadProgress:function(){},downloadProgress:function(){},contentType:"application/json"},t.start=function(){},t.complete=function(){},"undefined"!=typeof e.crypto&&"function"==typeof e.crypto.getRandomValues){t.token="";for(var a=0;4>a;a++)t.token+=e.crypto.getRandomValues(new Uint32Array(1))}else t.token=Math.random()+""+Math.random();return t.ajax=function(a,o){var s=$.extend({},t.defaults,o),n={};n.type=s.type,n.success=s.success,n.error=s.error,n.url=s.url,n.uploadProgress=s.uploadProgress,n.downloadProgress=s.downloadProgress,n.get=s.get?o.get:"",n.path=a,n.data=s.data,n.contentType=s.contentType,n.bypassMainQuery=s.bypassMainQuery,n.params=o,n.start=t.start,n.complete=t.complete,n.get.length&&!n.get.startsWith("?")&&(n.get="?"+n.get);var d=new Date;d.setTime(d.getTime()+864e5),r.cookie="dpjs_token="+t.token+"; expires="+d.toGMTString()+"; path=/";var p={url:n.url||dustpressjs_endpoint||e.location+n.get,method:n.type,contentType:n.contentType,data:{dustpress_data:{path:a,args:n.args,render:n.render,tidy:n.tidy,partial:n.partial,data:n.data,token:t.token,bypassMainQuery:n.bypassMainQuery}}};return p.data=JSON.stringify(p.data),s.upload&&(p.xhr=function(){var r=new e.XMLHttpRequest;r.upload.addEventListener("progress",n.uploadProgressHandler,!1),r.addEventListener("progress",n.downloadProgressHandler,!1)}),n.start(),n.successHandler=function(t,a,o){var s;if(s="string"==typeof t?$.parseJSON(t):t,r.cookie="dpjs_token=; expires=-1; path=/",e.DustPressDebugger){delete n.params.success,delete n.params.error;var d={params:n.params,data:s.debug?s.debug:s};e.DustPressDebugger.extend(d,n.path)}void 0===s.error?n.success(s.success,s.data,a,o):n.error(s,a,o)},n.errorHandler=function(e,t,a){r.cookie="dpjs_token=; expires=-1; path=/",n.error({error:a},t,e)},n.uploadProgressHandler=function(e){if(e.lengthComputable){var r=e.loaded/e.total;n.uploadProgress(r)}},n.downloadProgressHandler=function(e){if(e.lengthComputable){var r=e.loaded/e.total;n.downloadProgress(r)}},$.ajax(p).done(n.successHandler).fail(n.errorHandler).complete(n.complete)},t}(window,document,jQuery);var dp=window.DustPress.ajax;